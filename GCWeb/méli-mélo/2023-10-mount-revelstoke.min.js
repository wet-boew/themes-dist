/*!
 * @title Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * @license wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v15.0.0 - 2024-05-01
 *
 */
!function(o,e,r,n){"use strict";var i,a="campaign-menu",l="."+a+".gcweb-menu",t=n.doc,s=function(n){return function(e){var t=n.find("> ul > li"),a="";o.each(t,function(e,t){var n=t.querySelector("a"),t=n.getAttribute("href"),n=n.textContent;a+=`<li><a href="${t}">${n}</a></li>`});t=r.querySelector(l+" > h2"),a=`
                <nav id="wb-sm" class="campaign-menu wb-menu visible-md visible-lg" data-trgt="mb-pnl" data-ajax-replace="${n[0].getAttribute("data-megamenu-ajax")}">
                    <div class="pnl-strt nvbar">
                        <h2>${t.textContent}</h2>
                        <ul role="menubar" class="list-inline menu">
                            ${a}
                        </ul>
                    </div>
                </nav>`;n.addClass("visible-sm visible-xs"),o(".gcweb-menu").after('<div id="mb-pnl" hidden></div>'),o(".gcweb-menu").after('<div id="wb-glb-mn" hidden><h2> </h2></div>'),n.after(a),o(".wb-menu").trigger("wb-init.wb-menu"),o(r).on("wb-ready.wb-menu",c)}},c=function(){o("#mb-pnl").remove(),o("#wb-glb-mn").remove()},u=function(e){let t=e.parentElement;for(;"NAV"!=t.nodeName&&"BODY"!=t.nodeName;)t=t.parentElement;return"NAV"==t.nodeName&&t};o(e).on("resize",function(){"A"==r.activeElement.nodeName&&(i=r.activeElement)}),t.on(n.resizeEvents,function(){if(null!=i){let e=u(i);if(e){let n=i.getAttribute("href");if(e.classList.contains("wb-menu")&&o(".wb-menu").is(":hidden")){for(var t=o(".gcweb-menu a[aria-expanded=true]"),a=0;a<t.length;a++)o(t).eq(a).attr("aria-expanded","false");if(o(l).find("button").attr("aria-expanded","true"),n.match("^#")){var r=n.substring(14);let e=o(".gcweb-menu a[aria-controls='gc-sub-menu-"+r+"']");null!=e?(e.focus(),e[0].hasAttribute("aria-haspopup")&&"true"==e[0].getAttribute("aria-haspopup")&&e.attr("aria-expanded","true")):console.warn("Unable to find equivalent link in GCWeb menu top level items")}else{let e=o('.gcweb-menu a[href="'+n+'"]'),t=o(e).parents("ul");if(1<t.length){let e=t.eq(0);e.parent().children("a").attr("aria-expanded","true")}null!=e?e.focus():console.warn("Unable to find equivalent link in GCWeb menu submenu items")}}else if(e.classList.contains("gcweb-menu")&&o(".gcweb-menu").is(":hidden"))if(o(".wb-menu li").removeClass("active sm-open"),o(".wb-menu ul.open").attr("aria-expanded","false"),o(".wb-menu ul.open").attr("aria-hidden","true"),o(".wb-menu ul").removeClass("open"),n.match("^#")){let e=o(i).attr("aria-controls");r=e.substring(12);let t=o(".wb-menu a[href='#wet-sub-menu-"+r+"']");null!=t?t.focus():console.warn("Unable to find equivalent link in WET megamenu top level items")}else{let e=o('.wb-menu a[href="'+n+'"]'),t=o(e).parents("ul");if(1<t.length){let e=t.eq(0);e.attr("aria-expanded","true"),e.attr("aria-hidden","false"),e.addClass("open"),e.parent().addClass("active sm-open")}null!=e?e.focus():console.warn("Unable to find equivalent link in WET megamenu submenu items")}}}}),t.on("timerpoke.wb wb-init.campaign-menu.gcweb-menu",l,function(e){var t=n.init(e,a,l);if(t){e=o(t);if(1<r.querySelectorAll(".gcweb-menu").length)return console.warn(a+" - gcweb menu already exsits on the page, hiding gcweb campaign menu and aborting"),e.addClass("hidden"),void n.ready(e,a);t=r.querySelector("#wb-sm");if(null!=t||null!=t)return console.warn(a+" - megamenu already exsits on the page, aborting"),e.addClass("hidden"),void n.ready(e,a);o(r).on("wb-ready.wb",s(e)),n.ready(e,a)}}),n.add(l)}(jQuery,window,document,wb),function(n,a,r){"use strict";var o="collection-sort",i="."+o,l=r.doc,s={};l.on("collection-sort",i,function(e,t){var n=e.currentTarget;function a(){n.querySelectorAll(t.section).forEach(function(e){e=e.querySelectorAll(t.selector);let n=[],a=[];e.forEach(function(e){a.push(e.parentElement);e={elm:e,sortVal:""};n.push(e)}),t.sort.forEach(function(t){n.forEach(function(e){e.sortVal=e.elm.querySelector(t.selector).innerHTML}),"numeric"===t.type?"desc"===t.order?n.sort((e,t)=>t.sortVal-e.sortVal):n.sort((e,t)=>e.sortVal-t.sortVal):"desc"===t.order?n.sort((e,t)=>t.sortVal.localeCompare(e.sortVal)):n.sort((e,t)=>e.sortVal.localeCompare(t.sortVal))}),n.forEach(function(e,t){a[t].append(e.elm)})})}t.section&&t.selector&&t.sort&&(a(),l.on("wb-contentupdated",i,function(e,t){a()}))}),l.on("timerpoke.wb wb-init.collection-sort",i,function(e){var t=r.init(e,o,i);t&&(e=n(t),t=n.extend(!0,{},s,a[o],r.getData(e,o)),e.trigger("collection-sort",t),r.ready(e,o))}),r.add(i)}(jQuery,window,wb),function(o,n,m){"use strict";var i="distance-calculator",a="."+i,e=m.doc,r={};e.on("distance-calculator",a,function(e,u){var a=e.currentTarget,r=o(a);function d(e){return e*(Math.PI/180)}r.find(u.form).on("submit",function(e){var t=e.currentTarget.querySelector(u.location).value,e=encodeURIComponent(t),n=a.querySelector(u.section).querySelectorAll(u.selector),t="fr"===m.lang?"https://geogratis.gc.ca/services/geolocation/fr/locate?q=":"https://geogratis.gc.ca/services/geolocation/en/locate?q=";return o.getJSON(t+e,function(e){if(0==e.length)console.log("Empty response from geogratis");else{var s=e[0].geometry.coordinates[0],c=e[0].geometry.coordinates[1],t=e[0].title;if(n.forEach(function(e){let t=e.querySelector(u.target),n=e.querySelector(u.sort);var a,r,o,i,l;void 0!==t&&null!==t&&void 0!==n&&null!==n&&void 0!==t.dataset.distanceCoordinates&&null!==t.dataset.distanceCoordinates&&(r=(i=JSON.parse(t.dataset.distanceCoordinates)).longtitude,l=i.latitude,a="fr"===m.lang?" ":",",o=s,e=r,l=d((i=l)-(r=c)),o=d(e-o),o=Math.sin(l/2)*Math.sin(l/2)+Math.cos(d(r))*Math.cos(d(i))*Math.sin(o/2)*Math.sin(o/2),o=6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))),n.innerHTML=Math.round(o),t.innerHTML=function(e,t){for(var n=(e=(e+="").split("."))[0],e=1<e.length?"."+e[1]:"",a=/(\d+)(\d{3})/;a.test(n);)n=n.replace(a,"$1"+t+"$2");return n+e}(Math.round(o),a))}),void 0!==u.name&&null!==u.name){let e=a.querySelectorAll(u.name);e.forEach(function(e){e.innerHTML=t})}if("object"==typeof u.display&&void 0!==u.display.selector&&void 0!==u.display.removeClass&&null!==u.display.selector&&null!==u.display.removeClass){let e=a.querySelectorAll(u.display.selector);e.forEach(function(e){e.classList.remove(u.display.removeClass)})}r.trigger("wb-contentupdated",[{source:i}])}}),!1})}),e.on("timerpoke.wb wb-init.distance-calculator",a,function(e){var t=m.init(e,i,a);t&&(e=o(t),t=o.extend(!0,{},r,n[i],m.getData(e,i)),e.trigger("distance-calculator",t),m.ready(e,i))}),m.add(a)}(jQuery,window,wb);