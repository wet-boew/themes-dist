/*!
 * @title Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * @license wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v14.1.0 - 2023-11-21
 *
 */
!function(c,e,r,u){"use strict";var o,d="campaign-menu",m="."+d+".gcweb-menu",t=u.doc;c(e).on("resize",function(){"A"==r.activeElement.nodeName&&(o=r.activeElement)}),t.on(u.resizeEvents,function(){if(null!=o){let e=function(e){let t=e.parentElement;for(;"NAV"!=t.nodeName&&"BODY"!=t.nodeName;)t=t.parentElement;return"NAV"==t.nodeName&&t}(o);if(e){let n=o.getAttribute("href");if(e.classList.contains("wb-menu")&&c(".wb-menu").is(":hidden")){for(var t=c(".gcweb-menu a[aria-expanded=true]"),a=0;a<t.length;a++)c(t).eq(a).attr("aria-expanded","false");if(c(m).find("button").attr("aria-expanded","true"),n.match("^#")){var r=n.substring(6);c(".gcweb-menu a[aria-controls='sub-menu-"+r+"']").focus()}else{let e=c('.gcweb-menu a[href="'+n+'"]'),t=c(e).parents("ul");if(1<t.length){let e=t.eq(0);e.parent().children("a.item").attr("aria-expanded","true")}e.focus()}}else if(e.classList.contains("gcweb-menu")&&c(".gcweb-menu").is(":hidden"))if(c(".wb-menu li").removeClass("active sm-open"),c(".wb-menu ul.open").attr("aria-expanded","false"),c(".wb-menu ul.open").attr("aria-hidden","true"),c(".wb-menu ul").removeClass("open"),n.match("^#")){let e=c(o).attr("aria-controls");r=e.substring(9);c(".wb-menu a[href='#menu-"+r+"']").focus()}else{let e=c('.wb-menu a[href="'+n+'"]'),t=c(e).parents("ul");if(1<t.length){let e=t.eq(0);e.attr("aria-expanded","true"),e.attr("aria-hidden","false"),e.addClass("open"),e.parent().addClass("active sm-open")}e.focus()}}}}),t.on("timerpoke.wb wb-init.campaign-menu.gcweb-menu",m,function(e){var t=u.init(e,d,m);if(t){for(var n=(e=c(t)).find("ul ul"),a=1;a<n.length+1;a++)n.eq(a-1).attr("id","sub-menu-"+a);if(1<r.querySelectorAll(".gcweb-menu").length)return console.warn(d+" - gcweb menu already exsits on the page, hiding gcweb campaign menu and aborting"),e.addClass("hidden"),void u.ready(e,d);t=r.querySelector("#wb-sm");if(null!=t||null!=t)return console.warn(d+" - megamenu already exsits on the page, aborting"),e.addClass("hidden"),void u.ready(e,d);var o=e.find("> ul > li"),i="",l=0,s=0;c.each(o,function(e,t){l++;var n=t.querySelector("a");n.setAttribute("class","item");var a,r,t=t.querySelectorAll("li");0<t.length?(r="menu-"+ ++s,a="",i+=`
                        <li><a href="#${r}" class="item" tabindex="0" aria-posinset="${l}" aria-setsize="${o.length}" role="menuitem" aria-haspopup="true">${n.textContent}</a>`,c.each(t,function(e,t){var n=t.querySelector("a"),t=n.getAttribute("href");a+=`<li><a href="${t}">${n.textContent}</a></li>`}),i+=`<ul class="sm list-unstyled" id="${r}" role="menu">${a}</ul></li>`):(r=n.getAttribute("href"),i+=`<li><a href="${r}">${n.textContent}</a></li>`)});i=`
                <nav id="wb-sm" class="campaign-menu wb-menu visible-md visible-lg">
                    <div class="pnl-strt nvbar">
                        <h2>${r.querySelector(m+" > h2").textContent}</h2>
                        <ul role="menubar" class="list-inline menu">
                            ${i}
                        </ul>
                    </div>
                </nav>`;e.addClass("visible-sm visible-xs"),e.after(i),c(".wb-menu").attr("data-trgt","mb-pnl"),c(".wb-menu").after('<div id="mb-pnl" hidden></div>'),c(".wb-menu").after('<div id="wb-glb-mn" hidden><h2> </h2></div>'),c(".wb-menu").trigger("wb-init.wb-menu"),c("#mb-pnl").remove(),c("#wb-glb-mn").remove(),c(".wb-menu").removeAttr("data-trgt"),u.ready(e,d)}}),u.add(m)}(jQuery,window,document,wb),function(n,a,r){"use strict";var o="collection-sort",i="."+o,l=r.doc,s={};l.on("collection-sort",i,function(e,t){var n=e.currentTarget;function a(){n.querySelectorAll(t.section).forEach(function(e){e=e.querySelectorAll(t.selector);let n=[],a=[];e.forEach(function(e){a.push(e.parentElement);e={elm:e,sortVal:""};n.push(e)}),t.sort.forEach(function(t){n.forEach(function(e){e.sortVal=e.elm.querySelector(t.selector).innerHTML}),"numeric"===t.type?"desc"===t.order?n.sort((e,t)=>t.sortVal-e.sortVal):n.sort((e,t)=>e.sortVal-t.sortVal):"desc"===t.order?n.sort((e,t)=>t.sortVal.localeCompare(e.sortVal)):n.sort((e,t)=>e.sortVal.localeCompare(t.sortVal))}),n.forEach(function(e,t){a[t].append(e.elm)})})}t.section&&t.selector&&t.sort&&(a(),l.on("wb-contentupdated",i,function(e,t){a()}))}),l.on("timerpoke.wb wb-init.collection-sort",i,function(e){var t=r.init(e,o,i);t&&(e=n(t),t=n.extend(!0,{},s,a[o],r.getData(e,o)),e.trigger("collection-sort",t),r.ready(e,o))}),r.add(i)}(jQuery,window,wb),function(o,n,m){"use strict";var i="distance-calculator",a="."+i,e=m.doc,r={};e.on("distance-calculator",a,function(e,u){var a=e.currentTarget,r=o(a);function d(e){return e*(Math.PI/180)}r.find(u.form).on("submit",function(e){var t=e.currentTarget.querySelector(u.location).value,e=encodeURIComponent(t),n=a.querySelector(u.section).querySelectorAll(u.selector),t="fr"===m.lang?"https://geogratis.gc.ca/services/geolocation/fr/locate?q=":"https://geogratis.gc.ca/services/geolocation/en/locate?q=";return o.getJSON(t+e,function(e){if(0==e.length)console.log("Empty response from geogratis");else{var s=e[0].geometry.coordinates[0],c=e[0].geometry.coordinates[1],t=e[0].title;if(n.forEach(function(e){let t=e.querySelector(u.target),n=e.querySelector(u.sort);var a,r,o,i,l;void 0!==t&&null!==t&&void 0!==n&&null!==n&&void 0!==t.dataset.distanceCoordinates&&null!==t.dataset.distanceCoordinates&&(r=(i=JSON.parse(t.dataset.distanceCoordinates)).longtitude,l=i.latitude,a="fr"===m.lang?" ":",",o=s,e=r,l=d((i=l)-(r=c)),o=d(e-o),o=Math.sin(l/2)*Math.sin(l/2)+Math.cos(d(r))*Math.cos(d(i))*Math.sin(o/2)*Math.sin(o/2),o=6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))),n.innerHTML=Math.round(o),t.innerHTML=function(e,t){for(var n=(e=(e+="").split("."))[0],e=1<e.length?"."+e[1]:"",a=/(\d+)(\d{3})/;a.test(n);)n=n.replace(a,"$1"+t+"$2");return n+e}(Math.round(o),a))}),void 0!==u.name&&null!==u.name){let e=a.querySelectorAll(u.name);e.forEach(function(e){e.innerHTML=t})}if("object"==typeof u.display&&void 0!==u.display.selector&&void 0!==u.display.removeClass&&null!==u.display.selector&&null!==u.display.removeClass){let e=a.querySelectorAll(u.display.selector);e.forEach(function(e){e.classList.remove(u.display.removeClass)})}r.trigger("wb-contentupdated",[{source:i}])}}),!1})}),e.on("timerpoke.wb wb-init.distance-calculator",a,function(e){var t=m.init(e,i,a);t&&(e=o(t),t=o.extend(!0,{},r,n[i],m.getData(e,i)),e.trigger("distance-calculator",t),m.ready(e,i))}),m.add(a)}(jQuery,window,wb);