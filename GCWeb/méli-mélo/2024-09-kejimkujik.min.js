/*!
 * @title Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * @license wet-boew.github.io/wet-boew/License-en.html / wet-boew.github.io/wet-boew/Licence-fr.html
 * v13.9.0 - 2023-09-21
 *
 */
!function(s,r,n){"use strict";var o="campaign-menu",u="."+o+".gcweb-menu";n.doc.on("timerpoke.wb wb-init.campaign-menu.gcweb-menu",u,function(e){var t=n.init(e,o,u);if(t){e=s(t);if(1<r.querySelectorAll(".gcweb-menu").length)return console.warn(o+" - gcweb menu already exsits on the page, hiding gcweb campaign menu"),void e.addClass("hidden");e.addClass("visible-sm visible-xs");t=r.querySelector("#wb-sm");if(null!=t||null!=t)return console.warn(o+" can't start, megamenu already exsits on the page"),void n.ready(e,o);var a=r.querySelectorAll(u+" > ul > li"),l="",i=0,c=0;s.each(a,function(e,t){i++;var r=t.querySelector("a");r.setAttribute("class","item");var n,o,t=t.querySelectorAll("li");0<t.length?(o="menu-"+ ++c,n="",l+='<li><a href="#'+o+'" class="item" tabindex="0" aria-posinset="'+i+'" aria-setsize="'+a.length+'" role="menuitem" aria-haspopup="true">'+r.textContent,l+="</a>",s.each(t,function(e,t){var r=t.querySelector("a"),t=r.getAttribute("href");n+='<li><a href="'+t+'">'+r.textContent+"</a></li>"}),l+='<ul class="sm list-unstyled" id="'+o+'" role="menu">'+n+"</ul></li>"):(o=r.getAttribute("href"),l+='<li><a href="'+o+'">'+r.textContent+"</a></li>")});l=`
                <nav id="wb-sm" class="campaign-menu wb-menu visible-md visible-lg">
                    <div class="pnl-strt nvbar">
                        <h2>`+r.querySelector(u+" > h2").textContent+`</h2>
                        <ul role="menubar" class="list-inline menu">
                        `+l+`
                        </ul>
                    </div>
                </nav>`;e.after(l),n.ready(e,o),s(".wb-menu").attr("data-trgt","mb-pnl"),s(".wb-menu").after('<div id="mb-pnl" hidden></div>'),s(".wb-menu").after('<div id="wb-glb-mn" hidden><h2> </h2></div>'),s(".wb-menu").trigger("wb-init.wb-menu"),s("#mb-pnl").remove(),s("#wb-glb-mn").remove(),s(".wb-menu").removeAttr("data-trgt")}}),n.add(u)}(jQuery,(window,document),wb),function(r,n,o){"use strict";var a="collection-sort",l="."+a,i=o.doc,c={};i.on("collection-sort",l,function(e,t){var r=e.currentTarget;function n(){r.querySelectorAll(t.section).forEach(function(e){e=e.querySelectorAll(t.selector);let r=[],n=[];e.forEach(function(e){n.push(e.parentElement);e={elm:e,sortVal:""};r.push(e)}),t.sort.forEach(function(t){r.forEach(function(e){e.sortVal=e.elm.querySelector(t.selector).innerHTML}),"numeric"===t.type?"desc"===t.order?r.sort((e,t)=>t.sortVal-e.sortVal):r.sort((e,t)=>e.sortVal-t.sortVal):"desc"===t.order?r.sort((e,t)=>t.sortVal.localeCompare(e.sortVal)):r.sort((e,t)=>e.sortVal.localeCompare(t.sortVal))}),r.forEach(function(e,t){n[t].append(e.elm)})})}t.section&&t.selector&&t.sort&&(n(),i.on("wb-contentupdated",l,function(e,t){n()}))}),i.on("timerpoke.wb wb-init.collection-sort",l,function(e){var t=o.init(e,a,l);t&&(e=r(t),t=r.extend(!0,{},c,n[a],o.getData(e,a)),e.trigger("collection-sort",t),o.ready(e,a))}),o.add(l)}(jQuery,window,wb),function(a,r,m){"use strict";var l="distance-calculator",n="."+l,e=m.doc,o={};e.on("distance-calculator",n,function(e,u){var n=e.currentTarget,o=a(n);function d(e){return e*(Math.PI/180)}o.find(u.form).on("submit",function(e){var t=e.currentTarget.querySelector(u.location).value,e=encodeURIComponent(t),r=n.querySelector(u.section).querySelectorAll(u.selector),t="fr"===m.lang?"https://geogratis.gc.ca/services/geolocation/fr/locate?q=":"https://geogratis.gc.ca/services/geolocation/en/locate?q=";return a.getJSON(t+e,function(e){if(0==e.length)console.log("Empty response from geogratis");else{var c=e[0].geometry.coordinates[0],s=e[0].geometry.coordinates[1],t=e[0].title;if(r.forEach(function(e){let t=e.querySelector(u.target),r=e.querySelector(u.sort);var n,o,a,l,i;void 0!==t&&null!==t&&void 0!==r&&null!==r&&void 0!==t.dataset.distanceCoordinates&&null!==t.dataset.distanceCoordinates&&(o=(l=JSON.parse(t.dataset.distanceCoordinates)).longtitude,i=l.latitude,n="fr"===m.lang?" ":",",a=c,e=o,i=d((l=i)-(o=s)),a=d(e-a),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(d(o))*Math.cos(d(l))*Math.sin(a/2)*Math.sin(a/2),a=6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))),r.innerHTML=Math.round(a),t.innerHTML=function(e,t){for(var r=(e=(e+="").split("."))[0],e=1<e.length?"."+e[1]:"",n=/(\d+)(\d{3})/;n.test(r);)r=r.replace(n,"$1"+t+"$2");return r+e}(Math.round(a),n))}),void 0!==u.name&&null!==u.name){let e=n.querySelectorAll(u.name);e.forEach(function(e){e.innerHTML=t})}if("object"==typeof u.display&&void 0!==u.display.selector&&void 0!==u.display.removeClass&&null!==u.display.selector&&null!==u.display.removeClass){let e=n.querySelectorAll(u.display.selector);e.forEach(function(e){e.classList.remove(u.display.removeClass)})}o.trigger("wb-contentupdated",[{source:l}])}}),!1})}),e.on("timerpoke.wb wb-init.distance-calculator",n,function(e){var t=m.init(e,l,n);t&&(e=a(t),t=a.extend(!0,{},o,r[l],m.getData(e,l)),e.trigger("distance-calculator",t),m.ready(e,l))}),m.add(n)}(jQuery,window,wb);